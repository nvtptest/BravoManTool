IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[usp_sys_ZipFolder]') AND type IN (N'P', N'PC'))
DROP PROCEDURE [dbo].[usp_sys_ZipFolder]
GO

IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[usp_sys_MoveFileFromPath]') AND type IN (N'P', N'PC'))
DROP PROCEDURE [dbo].[usp_sys_MoveFileFromPath]
GO

IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[usp_sys_GetBinaryFromFilePath]') AND type IN (N'P', N'PC'))
DROP PROCEDURE [dbo].[usp_sys_GetBinaryFromFilePath]
GO

IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[usp_sys_GetBase64FromFilePath]') AND type IN (N'P', N'PC'))
DROP PROCEDURE [dbo].[usp_sys_GetBase64FromFilePath]
GO
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[usp_sys_ZipFromListFileXML]') AND type IN (N'P', N'PC'))
DROP PROCEDURE [dbo].[usp_sys_ZipFromListFileXML]
GO

IF EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ufn_sys_BravoManEncrypt]') AND type IN (N'FS'))
DROP FUNCTION [dbo].[ufn_sys_BravoManEncrypt]
GO

IF EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ufn_sys_ExtractFiles]') AND type IN (N'FT'))
DROP FUNCTION [dbo].[ufn_sys_ExtractFiles]
GO

IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[usp_sys_InsertB00EmailFileFromPath]') AND type IN (N'FS', N'PC'))
DROP PROCEDURE [dbo].usp_sys_InsertB00EmailFileFromPath
GO

IF EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ufn_sys_CheckFileExists]') AND type IN (N'FS'))
DROP FUNCTION [dbo].[ufn_sys_CheckFileExists]
GO

IF EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ufn_sys_ExtractLayoutFromTagName]') AND type IN (N'FT'))
DROP FUNCTION [dbo].[ufn_sys_ExtractLayoutFromTagName]
GO

IF EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ufn_sys_ConvertHtmlToText]') AND type IN (N'FS'))
DROP FUNCTION [dbo].[ufn_sys_ConvertHtmlToText]
GO

IF EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ufn_sys_GetAllCommandFromLayoutMain]') AND type IN (N'FT'))
DROP FUNCTION [dbo].[ufn_sys_GetAllCommandFromLayoutMain]
GO

--DROP ASSEMBLY
IF  EXISTS (SELECT * FROM sys.assemblies asms WHERE asms.name = N'BravoManTool')
DROP ASSEMBLY [BravoManTool]
GO
--DROP ASSEMBLY
IF  EXISTS (SELECT * FROM sys.assemblies asms WHERE asms.name = N'System.IO.Compression.FileSystem')
DROP ASSEMBLY [System.IO.Compression.FileSystem]
GO
--DROP ASSEMBLY
IF  EXISTS (SELECT * FROM sys.assemblies asms WHERE asms.name = N'System.IO.Compression')
DROP ASSEMBLY [System.IO.Compression]
GO
--DROP ASSEMBLY
--IF  EXISTS (SELECT * FROM sys.assemblies asms WHERE asms.name = N'System.Web')
--DROP ASSEMBLY [System.Web]
--GO

CREATE ASSEMBLY [System.IO.Compression]
FROM N'C:\Windows\Microsoft.NET\Framework\v4.0.30319\System.IO.Compression.dll' --Lưu ý đường dẫn cài .Net framework
WITH PERMISSION_SET = UNSAFE;
GO
CREATE ASSEMBLY [System.IO.Compression.FileSystem]
FROM N'C:\Windows\Microsoft.NET\Framework\v4.0.30319\System.IO.Compression.FileSystem.dll' --Lưu ý đường dẫn cài .Net framework
WITH PERMISSION_SET = UNSAFE;
GO

--C:\Windows\Microsoft.NET\Framework\v4.0.30319\System.Web.dll
--CREATE ASSEMBLY [System.Web]
--FROM N'C:\Windows\Microsoft.NET\Framework\v4.0.30319\System.Web.dll' --Lưu ý đường dẫn cài .Net framework
--WITH PERMISSION_SET = UNSAFE;
--GO


--DROP ASSEMBLY
IF  EXISTS (SELECT * FROM sys.assemblies asms WHERE asms.name = N'System.Windows.Forms')
DROP ASSEMBLY [System.Windows.Forms]
GO
CREATE ASSEMBLY [System.Windows.Forms]
FROM N'C:\Windows\Microsoft.NET\Framework\v4.0.30319\System.Windows.Forms.dll' --Lưu ý đường dẫn cài .Net framework
WITH PERMISSION_SET = UNSAFE;
GO

CREATE ASSEMBLY [BravoManTool]
--FROM 'D:\zProject_DotNet\BravoManTool\BravoManTool\bin\Debug\BravoManTool.dll'
FROM 0x4D5A90000300000004000000FFFF0000B800000000000000400000000000000000000000000000000000000000000000000000000000000000000000800000000E1FBA0E00B409CD21B8014CCD21546869732070726F6772616D2063616E6E6F742062652072756E20696E20444F53206D6F64652E0D0D0A2400000000000000504500004C01030022757FE10000000000000000E00022200B0130000052000000060000000000007670000000200000008000000000001000200000000200000400000000000000060000000000000000C000000002000000000000030060850000100000100000000010000010000000000000100000000000000000000000247000004F00000000800000C00300000000000000000000000000000000000000A000000C0000008C6F0000380000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000080000000000000000000000082000004800000000000000000000002E746578740000007C500000002000000052000000020000000000000000000000000000200000602E72737263000000C0030000008000000004000000540000000000000000000000000000400000402E72656C6F6300000C00000000A000000002000000580000000000000000000000000000400000420000000000000000000000000000000058700000000000004800000002000500B0380000DC36000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001B300300AC000000010000110072010000700A281C00000A0B0703281D00000A0C0204281D00000A0D000E04130411042C49000805281E00000A000918731F00000A1305110517732000000A13060011060803282100000A2600DE0D11062C0811066F1400000A00DCDE0D11052C0811056F1400000A00DC002B0A000905281E00000A000000DE0E13070011076F2200000A0A00DE00DE180008282300000A130811082C090008282400000A000000DC0613092B0011092A01340000020042000E50000D0000000002003800275F000D0000000000001D005F7C000E1600000102001D006F8C0018000000001B30030070010000020000110004720100007051281C00000A0A732500000A0D00732600000A13051105026F2700000A6F2800000A001105732900000A1306732A00000A1307110711066F2B00000A260318731F00000A1308110817732000000A1309000011076F2C00000A166F2D00000A6F2E00000A6F2F00000A130A2B5D110A6F1800000A741E000001130B00110B72070000706F3000000A6F3100000A0C0608281D00000A0B110B72190000706F3000000A6F3100000A283200000A1304071104281E00000A0009076F3300000A0011090708282100000A2600110A6F1500000A2D9ADE16110A751F000001130C110C2C08110C6F1400000A00DC00DE0D11092C0811096F1400000A00DCDE0D11082C0811086F1400000A00DC00DE0F130D0004110D6F2200000A5100DE00DE4A0000096F3400000A130E2B22120E283500000A130F00110F282300000A131011102C0A00110F282400000A000000120E283600000A2DD5DE0F120EFE160400001B6F1400000A00DC00DC2A4194000002000000720000006A000000DC000000160000000000000002000000570000009E000000F50000000D00000000000000020000004D000000B7000000040100000D00000000000000000000001400000000010000140100000F00000016000001020000002F0100002F0000005E0100000F00000000000000020000001400000011010000250100004A000000000000001B300300A700000003000011000E05720100007051281C00000A0A0603281D00000A0B0204281D00000A0C000E040D092C49000705281E00000A000818731F00000A1304110417732000000A13050011050703282100000A2600DE0D11052C0811056F1400000A00DCDE0D11042C0811046F1400000A00DC002B0A000805281E00000A000000DE101306000E0511066F2200000A5100DE00DE180007282300000A130711072C090007282400000A000000DC2A0001340000020042000E50000D0000000002003800275F000D0000000000001F005D7C00101600000102001F006F8E0018000000001B3003008C000000040000110072310000700A733700000A0B7275000070733800000A0D0609733900000A13041104733A00000A13051105076F3B00000A26DE0D11052C0811056F1400000A00DCDE0D11042C0811046F1400000A00DCDE0B092C07096F1400000A00DC076F3C00000A0C081672A90000706F3D00000A00076F2E00000A086F3E00000A00076F2E00000A13062B0011062A0128000002002A000B35000D00000000020021002344000D00000000020018003B53000B00000000133002003300000005000011000F00283F00000A0A062C0C1201FE1526000001070C2B19284000000A0F00284100000A6F4200000A734300000A0C2B00082A00133002003300000006000011000F00284400000A0A062C0C1201FE1527000001070C2B19284000000A0F00284500000A6F4600000A734700000A0C2B00082A001B3002008000000007000011000F00283F00000A0C082C0D72B3000070734700000A0D2B65734800000A0A00060F00284100000A6F4900000A0000DE162600066F4A00000A0072B5000070734700000A0DDE3772B30000700B00066F4B00000A0B00DE162600066F4A00000A0072D3000070734700000A0DDE10066F4A00000A0007734700000A0D2B00092A011C000000001F00123100161000000100004D000B580016100000011B3007007800000008000011000472010000705100284C00000A0A0203284D00000A00284C00000A0B041B8D4100000125160450A225177207010070A225181200720B010070284E00000A284F00000AA225197207010070A2251A1201720B010070284E00000A284F00000AA2285000000A5100DE0D0C0004086F2200000A5100DE002A0110000000000800626A000D160000011B3002003C0000000900001100000302285100000A735200000A51047201000070285300000A812700000100DE190A0003145104066F2200000A285300000A812700000100DE002A011000000000010021220019160000011B300200500000000A000011000002285100000A0A0306285400000A285300000A8127000001047201000070285300000A812700000100DE220B000314285300000A812700000104076F2200000A285300000A812700000100DE002A01100000000001002C2D0022160000011B300300BB0000000B00001100285500000A0A0006284000000A72330100706F4200000A6F5600000A0006284000000A72750100706F4200000A6F5700000A0006066F5800000A066F5900000A6F5A00000A0B735B00000A0C00080717735C00000A0D0009735D00000A13040011040F00284100000A6F5E00000A0000DE0D11042C0811046F1400000A00DC00DE0B092C07096F1400000A00DC086F5F00000A285400000A285300000A1305DE16082C07086F1400000A00DC062C07066F1400000A00DC11052A0001340000020060001373000D00000000020057002C83000B0000000002004D0055A2000B0000000002000700A6AD000B000000001B300300860000000C000011000002282300000A16FE010B072C0A0005729701007051DE6C020A040C082C39000272D1010070286000000A0D0917286100000A13040011040202286200000A282100000A2600DE0D11042C0811046F1400000A00DC090A00060317286300000A000572010000705100DE191305000572DB01007011056F2200000A281D00000A5100DE002A0000011C0000020036001349000D00000000000001006B6C0019160000011B300100220000000D00001100000F00284100000A282300000A286400000A0ADE0A26007E6500000A0ADE00062A000001100000000001001516000A100000015A1FFE732700000625027D0B00000425037D0D0000042A00133002004E0000000E000011000274040000020A03066F1E000006286600000A813300000104066F20000006734700000A812700000105066F22000006734700000A81270000010E04066F24000006734700000A81270000012A00001B300300C00000000F00001100000F02286700000A2C190F00284100000A286800000A72D10100701B6F6900000A2B01160A062C66000F00284100000A286A00000A0B0000076F6B00000A6F6C00000A0C2B22086F6D00000A0D000F01286E00000A096F6F00000A09281300000628110000060000086F1500000A2DD6DE0B082C07086F1400000A00DC00DE0B072C07076F1400000A00DC002B27000F01286E00000A0F00284100000A286200000A0F00284100000A28120000062811000006000000DE0613040000DE002A01280000020045002E73000B00000000020037004A81000B0000000000000100B8B90006160000011B300300A0000000100000110003286800000A0A03287000000A0B72E7010070733800000A0C00086F7100000A00721702007008733900000A0D00096F7200000A7228030070028C5A0000016F7300000A26096F7200000A7244030070076F7300000A26096F7200000A7258030070066F7300000A26096F7200000A7276030070046F7300000A26096F7400000A2600DE0B092C07096F1400000A00DC00DE0B082C07086F1400000A00DC2A011C000002002E005886000B0000000002001A007A94000B000000001330010013000000110000110002285100000A0A06285400000A0B2B00072A001B3002003E0000001200001100026F7500000A0A00735B00000A0B0006076F7600000A00076F5F00000A285400000A0CDE16072C07076F1400000A00DC062C07066F1400000A00DC082A0000011C000002000F001726000B00000000020008002931000B0000000013300300AD00000013000011000F00283F00000A0B072C0B7E7700000A0C38940000000F00284100000A728603007072B3000070287800000A6F7900000A0A0672A403007072B3000070287800000A0A0672BA030070287A00000A6F7B00000A72C4030070287A00000A6F7B00000A72D0030070287A00000A6F7B00000A72DE030070287A00000A6F7B00000A72E6030070287A00000A6F7B00000A0A0672F003007072F8030070287800000A0A06734700000A0C2B00082A2202287C00000A002A00001B300800F70000001400001100737D00000A0A026F7E00000A2D0E0F01284100000A287F00000A2B01170D092C0806130438CA000000732600000A0B07026F8000000A6F8100000A000772FC0300700F01284100000A281D00000A6F8200000A0C00086F8300000A13052B6E11056F1800000A743E00000113060011062818000006130711066F8400000A1308110617281900000613091106182819000006130A1106192819000006130B11061A2819000006130C11061B2819000006130D06110811071109110A110B110C110D280100002B6F8600000A000011056F1500000A2D89DE161105751F000001130E110E2C08110E6F1400000A00DC0613042B0011042A000110000002005E007BD90016000000001330020084000000150000110002740800001B0A03066F8700000A734700000A812700000104066F8800000A734700000A812700000105066F8900000A734700000A81270000010E04066F8A00000A734700000A81270000010E05066F8B00000A734700000A81270000010E06066F8C00000A734700000A81270000010E07066F8D00000A734700000A81270000012A13300200590000001600001100022C0C026F8E00000A1F09FE012B01170B072C09007E8F00000A0C2B39026F9000000A28180000060A067E8F00000A289100000A2D0D067202040070281D00000A2B0572B3000070026F9200000A281D00000A0C2B00082A00000013300200530000001700001100020A160B2B3700066F9000000A2C14066F9000000A6F8E00000A1F09FE0116FE012B01160C082C0B00066F9000000A0A002B0500140D2B18000717580B0703FE04130411042DBF066F9200000A0D2B00092A001B3004001402000018000011000F00283F00000A2D160F00284100000A7E8F00000A6F9300000A16FE012B0116130411042C15007206040070028C27000001289400000A0A002B080072E70100700A000F01283F00000A2D130F01284100000A7E8F00000A6F9300000A2C077E8F00000A2B1672500400700F01284100000A7254040070289500000A0B1B8D410000012516725A040070A2251707A225187243070070A2251907A2251A72A5070070A2285000000A0C739600000A0D06733800000A13050011056F7100000A00081105733900000A13060011066F9700000A13070038F100000000110772280800706F9800000A6F3100000A1308110772440800706F9800000A6F3100000A13091107725A0800706F9800000AA562000001130A110772740800706F9800000AA562000001130B1107728A0800706F9800000A6F3100000A130C110A130D110D398500000000732600000A130E110E11086F8100000A00110E6F9900000A130F110F14FE03131011102C5E00110F729C0800706F9A00000A1311111114FE03131311132C1500111172B20800700972D0080070281B0000060000110F72DA0800706F9A00000A1312111214FE03131411142C1500111272B20800700972EE080070281B000006000000000011076F9B00000A131511153AFFFEFFFF00DE0D11072C0811076F1400000A00DC00DE0D11062C0811066F1400000A00DC00DE0D11052C0811056F1400000A00DC0913162B0011162A414C000002000000D50000000A010000DF0100000D0000000000000002000000CB00000024010000EF0100000D0000000000000002000000B800000047010000FF0100000D000000000000001B300500310100001900001100160A00026F9C00000A6F8300000A0B2B72076F1800000A743E0000010C00086F9200000A72F6080070289100000A0D092C5000170A00086F9C00000A6F8300000A13042B1B11046F1800000A743E0000011305001105030405281B000006000011046F1500000A2DDCDE161104751F000001130611062C0811066F1400000A00DC0000076F1500000A2D86DE1507751F000001130611062C0811066F1400000A00DC062D24026F9200000A7202090070289D00000A2C12026F9200000A720C090070289D00000A2B0116130711072C5F000272160900706F9A00000A252D0426142B056F8400000A252D0726026F9200000A130805289E00000A2D0F0572360900701108289500000A2B021108130904198D100000012516026F9200000AA2251703A225181109A26F9F00000A00002A000000011C000002004400286C001600000000020010007E8E001500000000133003007E0000001A0000110002740A00001B0A0306169A7441000001734700000A81270000010406179A7441000001734700000A81270000010506189A7441000001734700000A81270000010E0406199A7441000001734700000A81270000010E05061A9AA56200000173A000000A81300000010E06061B9A7441000001734700000A81270000012A2202287C00000A002A1E027B030000042A2202037D030000042A1E027B040000042A2202037D040000042A1E027B050000042A2202037D050000042A1E027B060000042A2202037D060000042A2202287C00000A002A6A02287C00000A0002037D070000040228A100000A7D090000042A001B300200720000001B000011027B070000040A061FFA591936082B0006172E022B5B00061FFA591836082B0006172E022B4000061FFA591736082B0006172E022B2500061FFA2E082B0006172E022B0C00DE0702282D000006DC2B00DE0702282C000006DC2B00DE0702282B000006DC2B00DE0702282A000006DC2B002A000001340000020045000247000700000000020037001B5200070000000002002700365D0007000000000200170051680007000000001B300600DE0200001C000011027B070000040B0745030000000200000004000000090000002B0C2B1138BA010000389A020000160ADDAE02000002157D070000040002027C0A000004284100000A7D0E000004027B0E000004282300000A16FE010C082C0800160ADD7B020000027C0C000004286700000A2C18027B0E000004286800000A72D10100701B6F6900000A2B01160D0939AE0100000002027B0E000004286A00000A7D0F000004021FFD7D070000040002177D100000040002027B0F0000046F6B00000A6F6C00000A7D11000004021FFC7D07000004383501000002027B110000046F6D00000A7D1200000400027B120000046FA200000A166AFE01130411042C05380901000002027B120000046F7500000A7D13000004021FFB7D0700000402735B00000A7D14000004021FFA7D0700000400027B13000004027B140000046F7600000A0002732600000625027B10000004130502110517587D1000000411056F1F0000060025027B120000046F6F00000A287000000A6F210000060025027B120000046F6F00000A286800000A289E00000A2D18027B120000046F6F00000A286800000A176FA300000A2B0572B30000706F230000060025027B140000046F5F00000A285400000A6F25000006007D0800000402177D07000004170ADD00010000021FFA7D070000040002282D0000060002147D1400000402282C0000060002147D130000040002147D12000004027B110000046F1500000A3ABBFEFFFF02282B0000060002147D110000040002282A0000060002147D0F0000040038940000000002027B0E000004285100000A7D1500000402732600000625176F1F0000060025027B0E000004287000000A6F210000060025027B0E000004286800000A289E00000A2D13027B0E000004286800000A176FA300000A2B0572B30000706F230000060025027B15000004285400000A6F25000006007D0800000402187D07000004170ADE1B02157D070000040002147D15000004160ADE0802282800000600DC062A0000411C00000400000000000000D4020000D402000008000000000000007202157D07000004027B0F0000042C0C027B0F0000046F1400000A002A76021FFD7D07000004027B110000042C0C027B110000046F1400000A002A76021FFC7D07000004027B130000042C0C027B130000046F1400000A002A76021FFB7D07000004027B140000042C0C027B140000046F1400000A002A1E027B080000042A1A73A400000A7A1E027B080000042A000013300200430000001D000011027B070000041FFE3318027B0900000428A100000A330B02167D07000004020A2B071673270000060A06027B0B0000047D0A00000406027B0D0000047D0C000004062A1E0228310000062A0042534A4201000100000000000C00000076342E302E33303331390000000005006C000000040F0000237E0000700F00007C12000023537472696E677300000000EC2100003C09000023555300282B0000100000002347554944000000382B0000A40B000023426C6F620000000000000002000001571FA20B090A000000FA01330016000001000000640000000500000015000000320000005100000005000000A400000002000000370000001D00000002000000060000000A000000070000000A000000010000000700000002000000010000000000A00901000000000006006307B50D0600D007B50D06001B067F0D0F00D50D000006005E063C0B060046073C0B060012073C0B0600B7073C0B060083073C0B06009C073C0B0600A9063C0B06004A06960D06000D06960D0600F5063C0B0600C4063F080600450F570A0A003107BC0C0A005B03BC0C0A006103BC0C0600060A12020E002308110B0600B20B570A0A009306BC0C0A00DC09230E06003D0066021200CD0FC10912002D0CC1090A004C0F2A020600D70CEA0E0A006A112A0206003204570A6700490D000006002604EA0E0A001C042A020A00980B8C0F0A0050038C0F0A00AD0C8C0F0A00D711230E0A007908230E16008711A40E06001505570A0A006A0E230E0600920DB5110600760AB51106001E0A12020600110AB5110600870C12020A00870A230E06003E05570A06007506B50D0A006B00230E06002F0066020E003B12110B0600240A12020600F205B50D0600C3057F0D06002F067F0D06000C0066020600DD067F0D0600AB01570A1200E610C1091200E603C1090A001F0C8C0F06003509120206008F08570A06006F0412020600A50312020E00AE03110B1A00B90E110B1200560CC1090A0099032A020A004E0B2A020A00790B2A020A0058052A020600DE10570A0A009F0CBC0B0600360806111E00D90F79091600FE09A40E1A006404110B0600E70B270B0600600C570A06005E0AB5110600BD03B5110600940C12020600CF0B570A06001A005A090A008B0BBC0B0A00620B8C0F06006E00570A0A007A0C8C0F0A004603BC0B1E008111CB0E0600C10F570A06007404570A12003705C1090A00120CBC0B06008A0A570A1200A20FC1090600A60B570A00000000E801000000000100010001001000F109F109410001000100010010000402F1094100030016000300100095090000410003001E0003011000480100004100070027005180AB119F0351805A0D9F030100F902B70401000D039F03010027039F030100E1029F030100DA05B7040100B510BA040100AA02B7040100F608D6020600F108D6020100F80B4C020600F30B4C02010001009F0301007400BD040100A900B70401001A01C10401005C01CB0401008101D00401009801D5040100C601DA045020000000009600E111DE0401003C21000000009600F101E80406004C230000000096000012F10409003424000000009600F210FD040F00F424000000009600D901060511003425000000009600030C0F05120074250000000096002411180513001C26000000009600700C21051400B026000000009600380E290517000827000000009600C70836051A007427000000009600CE1018051D007028000000009600FF0843051E002029000000009600140F4C0522006029000000009600160E550523007829000000009600700361052500D4290000000096003E0476052A00C82A000000009100730583052D00902B000000009100EF0033023000B02B00000000910003018A053100182C0000000096002E1118053200D12C000000008618540D06003300DC2C000000009600870E91053300F02D000000009600360F9C053500802E000000009100AC08BD053D00E82E000000009100BF04C4053E00482F0000000096004902CC054000B431000000009100DF03D805420010330000000096007211E70546009A33000000008618540D06004D00A33300000000860881029B024D00AB33000000008608880201004D00B43300000000860883048F004E00BC33000000008608900410004E00C533000000008608B60A8F004F00CD33000000008608C80A10004F00D633000000008608D9008F005000DE33000000008608E40010005000E733000000008618540D06005100F033000000008618540D010051000C3400000000E1018E0506005200C03400000000E101FD1028005200C8370000000081005D0006005200E5370000000081009B00060052000338000000008100CB000600520021380000000081003A01060052003F3800000000E109481038005200473800000000E101540F060052004E3800000000E1098A1038005200583800000000E101E30C04065200A73800000000E101270D4D00520000000100F60800000200970A00000300A90500000400C21000000500620400000100E30900000200A90502000300850F00000100F60800000200970A00000300A90500000400C21000000500620402000600850F00000100E30900000200A905000001004E11000001007C0E000001004E1100000100300900000200100902000300850F00000100F60802000200450E020003000E0400000100F608020002003602020003000E0400000100581100000100B80800000200DD08000003006C0402000400850F00000100F60800000100F60800000200F80B00000100450902000200DE0202000300A90402000400DA0A02000500130100000100F60800000200BF0200000300F80B00000100BF0200000200A90400000300130100000100F608000001004B1200000100EC0900000100410200000200D00400000100530902000200F80702000300A00802000400440002000500820002000600B20002000700210102000800680100000100FD0300000100FD03000002008F0900000100FF0400000200B20400000100FD03000002000A05000003000C0F00000400240900000100530902000200F604020003000A05020004001B1102000500E10402000600B80502000700D80400000100120800000100120800000100120800000100120800000100DA0505000A00050085000500060005007D00050075000900540D01001100540D06001900540D0A002900540D10003100540D10003900540D10004100540D10004900540D10005100540D10005900540D10006100540D15006900540D10007100540D10007900540D10008900540D0600B900540D06009101540D1A00B901540D0600C901540D2100F900A1050600E900FD1028000C00A9103300E900730F0600E900A91038001400460D43000901460D4D00D901540D06000102180962000902280F660011025C0E6C00A100540D7300A900540D7B0029024E048500B10002048F001102180F93001102E50598001C00540D0600D100540D0600C1003B0CCA00D100D502D000D900540DD700E100540D0600E100CC09DE00E1000B0EE70041022B0AED0011011F0FF4005102460D4D00F1002B0AFA00810083088F0059025908FF001C00DA0205011C00460D0B012400A91033002400FD1028001101540D06001901540D10002101540D3F012901540D47016102B1094E0111017A115501F100340A5A014902DA0260013901B60928006902BD0170013901EE078F006902730E76013101540D7C013101B60928003101EE078C0169028C0891013901540D10004101540D060041012E0810007102A1050600790212118F0049016211AD0181022712B30189024305B90149018308BF010902280FC70111024F0EFF005101540D7C013901790FD20159026A08E0015901B105FB019902A3117C01990223027C0199029B118C0199021C028C0199026F0D01026901540D06007101540D0B027901540D1802A902EC051000690193118C010102A60A66008102920A2A0201029D0433021102D21138028101790F4502810188054C029901790F56028101180828000102E80A330209029D0E70028102CC027802A900FF0D7E022C00460D43003400A91033009901EE079B02A901E9048F000102F50A3302C102920A06002101FD0EAA02C9020508B002E10217129B02A901920AC802B101E00B18023901BC09D602E9027E03DB020902710A8F00F1021E05620009027E03E2028100540D06003C00540D0600C100B6092800090286039300C100EE078F00D100D4091000F101F30D2303E901460D4D00F10140118F00F902B1052A033C00DA0205014400530033004400910075034400C1007A03440030017F0344007701840344008E0189034400B3018E03F1012A059903090273129F03F101EE03A20309025112A803F1017A048F0009029D0EE60309022F0FEB030902280FDB024C00540D06002101480CF80309032B0AFA00D100AD0FFE03F101CE0304040903D0022800F101E40D1F0409025D12A80309026B1293004C00DA0205018101540D1500F1028F022D04A9013A093E040902960842042103540D06000E00040055040E000800960420007B0015072E000B0019062E00130022062E001B0041062E0023004A062E002B005C062E0033005C062E003B0062062E0043004A062E004B0076062E0053005C062E005B005C062E00630094062E006B00BE062E007300CB0640008300630860008300630861009300630861009B009B0B80008300630881009300630881009B009B0BA0007B006808A10093006308A1009B009B0BA30093006308C0007B006808C10093006308C1009B009B0BE0007B00680800018300630860017B006308800183006308A0017B006308C0018B008D08C0017B00C00800028300630880027B006308C0027B004B0940037B00530AC00393006308E00393006308000493006308200493006308400493006308600493006308800493006308A00493006308E004DB0063080005DB006308C005DB006308E005DB0063080006DB0063082006DB0063084006DB00630852009D001C012A01660182019701A201CD01D901E6011F023F0251025D029F02B802BE02CE02E80259039303AE03B8030B04250431043504470404000100050005000000C9020D060000A00411060000CC0A110600000C0111060000E30F150600002110150602001E00030001001F00030002002000050001002100050002002200070001002300070002002400090001002500090002002E000B00020030000D00050050002900050052002B0005005C002D0005005E002F000500600031000500620033000500640035002C003C00C40015018902920212036803F1032A04048000000100000000000000000000000000F10900000400000000000000000000004C045D02000000000400000000000000000000004C042A02000000000400000000000000000000004C04110B000000000400000000000000000000004C04C109000000000400000000000000000000004C04A40E000000000400000000000000000000004C043D0A000000000400000000000000000000004C04570A0000000004000200050002000B014F0300000000003C706174683E355F5F310049456E756D657261626C65603100526561644F6E6C79436F6C6C656374696F6E60310049456E756D657261746F726031004C697374603100706172656E745461674E616D6531006765745F4974656D31003C3E6D5F5F46696E616C6C79310053716C496E743332003C617263686976653E355F5F3200706172656E745461674E616D6532006765745F4974656D32003C3E6D5F5F46696E616C6C7932003C69643E355F5F3300706172656E745461674E616D6533006765745F4974656D33003C3E6D5F5F46696E616C6C7933006765745F426173653634007365745F42617365363400436F6E7665727446696C65546F42617365363400436F6E76657274546F42617365363400626173653634003C3E735F5F3400706172656E745461674E616D6534006765745F4974656D34003C3E6D5F5F46696E616C6C7934003C4578747261637446696C65733E645F5F3135003C656E7472793E355F5F3500706172656E745461674E616D6535006765745F4974656D35003C73747265616D3E355F5F36006765745F4974656D36003C6D656D6F727953747265616D3E355F5F37005475706C656037006765745F4974656D37006765745F55544638003C66696C65436F6E74656E74733E355F5F38004E56617243686172546F55746638003C4D6F64756C653E007A697046726F6D4C69737446696C65584D4C00526561644C61796F7574584D4C0053797374656D2E494F006765745F4956007365745F49560053797374656D2E44617461006261736536344461746100786D6C44617461004665746368416E6450726F6365737344617461006D73636F726C69620053797374656D2E436F6C6C656374696F6E732E47656E65726963006765745F4964007365745F4964006765745F43757272656E744D616E616765645468726561644964003C3E6C5F5F696E697469616C546872656164496400656D61696C51756575654964004F70656E52656164004C6F616400416464006964003C4261736536343E6B5F5F4261636B696E674669656C64003C49643E6B5F5F4261636B696E674669656C64003C46696C654E616D653E6B5F5F4261636B696E674669656C64003C46696C65457874656E73696F6E3E6B5F5F4261636B696E674669656C64004462436F6D6D616E640053716C436F6D6D616E640053797374656D446174614163636573734B696E640046696C6C526F774D6574686F64005265706C6163650049734E756C6C4F725768697465537061636500586D6C526561644D6F64650046696C654D6F6465005A6970417263686976654D6F64650043727970746F53747265616D4D6F64650053656C65637453696E676C654E6F64650050726F63657373586D6C4E6F6465006765745F506172656E744E6F6465006E6F6465006765745F4D65737361676500726573756C744D65737361676500446174615461626C650049456E756D657261626C650049446973706F7361626C6500496E73657274456D61696C46696C6500437265617465456E74727946726F6D46696C650069735A697046696C65007A697046696C65005475706C65006765745F4E616D65006765745F46696C654E616D65007365745F46696C654E616D650047657446696C654E616D650066696C654E616D650064617461626173654E616D6500476574506172656E745461674E616D65007461674E616D6500706174684E616D6500646C6C4E616D65006765745F46756C6C4E616D6500666F726D4E616D65007365727665724E616D65006C61796F75744E616D65004461746554696D65006765745F4E65774C696E65006765745F4E6F64655479706500586D6C4E6F646554797065006765745F496E76617269616E7443756C7475726500496E7465726E616C44617461436F6C6C656374696F6E4261736500496E7365727446696C65546F44617461626173650046616C73650053797374656D2E49446973706F7361626C652E446973706F73650066696C654E616D6543726561746500697354656D706C61746500446562756767657242726F777361626C655374617465003C3E315F5F73746174650044656C65746500577269746500436F6D70696C657247656E65726174656441747472696275746500477569644174747269627574650044656275676761626C6541747472696275746500446562756767657242726F777361626C6541747472696275746500436F6D56697369626C6541747472696275746500417373656D626C795469746C65417474726962757465004974657261746F7253746174654D616368696E654174747269627574650053716C50726F63656475726541747472696275746500417373656D626C7954726164656D61726B417474726962757465005461726765744672616D65776F726B41747472696275746500446562756767657248696464656E41747472696275746500417373656D626C7946696C6556657273696F6E41747472696275746500417373656D626C79436F6E66696775726174696F6E4174747269627574650053716C46756E6374696F6E41747472696275746500417373656D626C794465736372697074696F6E41747472696275746500436F6D70696C6174696F6E52656C61786174696F6E7341747472696275746500417373656D626C7950726F6475637441747472696275746500417373656D626C79436F7079726967687441747472696275746500417373656D626C79436F6D70616E794174747269627574650052756E74696D65436F6D7061746962696C697479417474726962757465006765745F56616C756500636F6D6D616E6456616C7565004164645769746856616C75650076616C7565006765745F497354727565005A697041726368697665007365745F52746600456E636F64696E670053797374656D2E52756E74696D652E56657273696F6E696E670046726F6D426173653634537472696E6700546F426173653634537472696E670053716C537472696E6700546F537472696E6700476574537472696E6700537562737472696E6700636F6D6D616E6450617468004765744E6F64655061746800736F7572636546696C65506174680047657442617365363446726F6D46696C65506174680064657374696E6174696F6E46696C6550617468003C3E335F5F66696C6550617468004D6F766546696C6546726F6D50617468007A6970506174680047657454656D70506174680063757272656E745061746800737461727450617468006765745F4C656E6774680066696C6544657461696C4F626A00726F774F626A0053797374656D2E436F6C6C656374696F6E732E4F626A6563744D6F64656C0053797374656D2E436F6D706F6E656E744D6F64656C006C6576656C0046696C6544657461696C00427261766F4D616E546F6F6C2E646C6C0046696C6C006765745F49734E756C6C0053797374656D2E586D6C0052656164586D6C004C6F6164586D6C0053716C586D6C00696E707574586D6C0068746D6C00427261766F4D616E546F6F6C00436F6E74726F6C0046696C6553747265616D0043727970746F53747265616D004D656D6F727953747265616D006765745F4974656D007365745F4974656D0053797374656D2E494F2E436F6D7072657373696F6E2E46696C6553797374656D0053796D6D6574726963416C676F726974686D005472696D004943727970746F5472616E73666F726D0053716C426F6F6C65616E004F70656E0066696C654E616D654F726967696E004368616E6765457874656E73696F6E006765745F46696C65457874656E73696F6E007365745F46696C65457874656E73696F6E0066696C65457874656E73696F6E00476574457874656E73696F6E0047657446696C654E616D65576974686F7574457874656E73696F6E0053797374656D2E494F2E436F6D7072657373696F6E0053797374656D2E476C6F62616C697A6174696F6E0053797374656D2E5265666C656374696F6E00446174615461626C65436F6C6C656374696F6E0053716C506172616D65746572436F6C6C656374696F6E0044617461526F77436F6C6C656374696F6E004462436F6E6E656374696F6E0053716C436F6E6E656374696F6E004E6F74537570706F72746564457863657074696F6E0053797374656D2E446174612E436F6D6D6F6E00537472696E67436F6D70617269736F6E00436F7079546F0043756C74757265496E666F003C3E335F5F657874726163745A69700055746638546F4E56617243686172004462446174615265616465720053716C4461746152656164657200586D6C4E6F646552656164657200437265617465526561646572004578656375746552656164657200586D6C5265616465720049466F726D617450726F7669646572007A6970466F6C6465720053716C506172616D657465720053747265616D577269746572005465787457726974657200446244617461416461707465720053716C4461746141646170746572004D6963726F736F66742E53716C5365727665722E5365727665720049456E756D657261746F720053797374656D2E436F6C6C656374696F6E732E47656E657269632E49456E756D657261626C653C53797374656D2E4F626A6563743E2E476574456E756D657261746F720053797374656D2E436F6C6C656374696F6E732E49456E756D657261626C652E476574456E756D657261746F72002E63746F7200496E697469616C697A6174696F6E566563746F7200437265617465456E63727970746F720053797374656D2E446961676E6F7374696373004165730053797374656D2E52756E74696D652E496E7465726F7053657276696365730053797374656D2E52756E74696D652E436F6D70696C6572536572766963657300446562756767696E674D6F646573006765745F4368696C644E6F6465730053656C6563744E6F646573006765745F456E7472696573006765745F5461626C6573004578747261637446696C65730053797374656D2E446174612E53716C54797065730047657446696C6542797465730066696C6542797465730052656164416C6C4279746573005772697465416C6C42797465730053716C427974657300476574427974657300696E7075744279746573004578747261637456616C756573416E64506174687300457175616C730053797374656D2E57696E646F77732E466F726D73005A697046696C65457874656E73696F6E730053797374656D2E546578742E526567756C617245787072657373696F6E730053797374656D2E436F6C6C656374696F6E73006765745F506172616D657465727300726573756C74730046696C65457869737473006765745F526F777300436F6E63617400466F726D61740046696C6C526F7745787472616374004F626A65637400446174615365740053797374656D2E436F6C6C656374696F6E732E49456E756D657261746F722E5265736574006F705F496D706C6963697400726573756C740053797374656D2E446174612E53716C436C69656E7400586D6C456C656D656E74006765745F446F63756D656E74456C656D656E7400456E7669726F6E6D656E7400586D6C446F63756D656E7400436F6D706F6E656E740053797374656D2E436F6C6C656374696F6E732E47656E657269632E49456E756D657261746F723C53797374656D2E4F626A6563743E2E43757272656E740053797374656D2E436F6C6C656374696F6E732E49456E756D657261746F722E43757272656E740053797374656D2E436F6C6C656374696F6E732E47656E657269632E49456E756D657261746F723C53797374656D2E4F626A6563743E2E6765745F43757272656E740053797374656D2E436F6C6C656374696F6E732E49456E756D657261746F722E6765745F43757272656E74003C3E325F5F63757272656E740066696C65436F6E74656E7400427261766F4D616E456E637279707400436F6E7665727400586D6C4E6F64654C69737400726561644C61796F7574004D6F76654E6578740053797374656D2E54657874006765745F5465787400666F726D5465787400527466546F5465787400436F6E7665727448746D6C546F54657874006765745F496E6E65725465787400696E7075745465787400706C61696E74657874006765745F4E6F770044617461526F770046696C6C526F77004E6577526F77005265676578005269636854657874426F7800546F4172726179006765745F4B6579007365745F4B6579005365637265744B65790053797374656D2E53656375726974792E43727970746F67726170687900436F70790053716C42696E6172790075666E5F7379735F577269746546696C6546726F6D56617242696E61727900777269746546696C6546726F6D56617242696E61727900457865637574654E6F6E51756572790043726561746546726F6D4469726563746F7279005A697041726368697665456E74727900656E747279006F705F457175616C697479006F705F496E657175616C6974790049734E756C6C4F72456D7074790000000000054F004B000011460069006C0065004E0061006D0065000017460069006C00650043006F006E00740065006E0074000043530045004C00450043005400200054004F0050002000310020005B00690064005D00460052004F004D00200042003000300055007300650072004C00690073007400003363006F006E007400650078007400200063006F006E006E0065006300740069006F006E0020003D0020007400720075006500000931003200330034000001001D4500720072006F00720020006C006F0061006400200072007400660000334500720072006F007200200063006F006E0076006500720074002000720074006600200074006F002000740065007800740000033B000027640064002F004D004D002F0079007900790079002000480048003A006D006D003A00730073000041420035003000300033004500320046003600360039003400340043004300310039003100310031003700310042004400380045003500350044003100320033000021320035003000430042003100380033003500390042003500340039004200420000394500520052003A002000460069006C00650020006700D11E630020006B006800F4006E00670020007400D31E6E0020007400A11E69002E0001092E007A0069007000000B4500520052003A002000002F63006F006E007400650078007400200063006F006E006E0065006300740069006F006E003D00740072007500650000810F49004E005300450052005400200049004E0054004F002000640062006F002E0042003000300045006D00610069006C00460069006C0065002000280045006D00610069006C0051007500650075006500490064002C002000460069006C0065004E0061006D0065002C002000460069006C00650045007800740065006E00730069006F006E002C00200042006100730065003600340029002000560041004C0055004500530020002800400045006D00610069006C0051007500650075006500490064002C0020004000460069006C0065004E0061006D0065002C0020004000460069006C00650045007800740065006E00730069006F006E002C00200040004200610073006500360034002900001B400045006D00610069006C00510075006500750065004900640000134000460069006C0065004E0061006D006500001D4000460069006C00650045007800740065006E00730069006F006E00000F4000420061007300650036003400001D3C005B005E003E005D002B003E007C0026006E006200730070003B0000153C0069006D0067005B005E003E005D002B003E0000093C00620072003E00000B3C00620072002F003E00000D3C006200720020002F003E0000073C0070003E0000093C002F0070003E0000075C0073002B000003200000052F002F0000032F0000495300650072007600650072003D007B0030007D003B0049006E00740065006700720061007400650064002000530065006300750072006900740079003D0074007200750065003B0000035B0000055D002E000082E70D000A00200020002000200020002000200020002000200020002000530045004C0045004300540020000D000A00200020002000200020002000200020002000200020002000200020002000200061002E00490064002C000D000A00200020002000200020002000200020002000200020002000200020002000200061002E0049007300540065006D0070006C006100740065002C000D000A00200020002000200020002000200020002000200020002000200020002000200061002E0046006F0072006D004E0061006D0065002C000D000A00200020002000200020002000200020002000200020002000200020002000200061002E004C00610079006F00750074004E0061006D0065002C000D000A00200020002000200020002000200020002000200020002000200020002000200061002E004C00610079006F007500740044006100740061002C000D000A00200020002000200020002000200020002000200020002000200020002000200061002E00490073004100630074006900760065002C000D000A002000200020002000200020002000200020002000200020002000200020002000640062006F002E00750066006E005F007300790073005F0054006F004C00610079006F007500740058006D006C00280061002E004C00610079006F00750074004400610074006100290020004100530020004C00610079006F0075007400440061007400610058006D006C002C000D000A002000200020002000200020002000200020002000200020002000200020002000490049004600280061002E0049007300540065006D0070006C006100740065003D003000200041004E004400200061002E0046006F0072006D004E0061006D0065003D0027004D00610069006E00570069006E0064006F00770027002C00200031002C002000300029002000490073004C00610079006F00750074004D00610069006E000D000A00200020002000200020002000200020002000200020002000460052004F004D0020000161640062006F002E0076004200300030004C00610079006F0075007400200041005300200061000D000A00200020002000200020002000200020002000200020002000200020002000200049004E004E004500520020004A004F0049004E002000008081640062006F002E0042003000300043006F006D006D0061006E0064002000630020004F004E00200063002E0043006F006D006D0061006E0064004B006500790020003D00200061002E0046006F0072006D004E0061006D006500200041004E004400200063002E004900730041006300740069007600650020003D0020003100001B4C00610079006F0075007400440061007400610058006D006C0000154C00610079006F00750074004E0061006D0065000019490073004C00610079006F00750074004D00610069006E00001549007300540065006D0070006C00610074006500001146006F0072006D004E0061006D00650000156D0065006E007500530074007200690070003100001D4C00610079006F00750074004E0061006D0065004D00610069006E0000094D0045004E00550000136E006100760069006700610074006F00720000074E0041005600000B4900740065006D007300000972006F006F00740000095400650078007400001F54006500780074002F0056006900650074006E0061006D0065007300650000035C000000002E5B1DA080700D4084D7009A00BE699A00042001010803200001052001011111042001010E0420010102062001011280C5062001011180E10320000206151280D1011C04200013000320001C06151280E9011C092000151280D101130004200012750F070A0E0E0E0E02125112551259020E0300000E0500020E0E0E060002010E1D05072002010E11810D092002011280D91181110900031280D512550E0E0320000E040001020E040001010E2607110E0E0E151265010E1D051269126D12711251125512751279127D125915118081010E0E0205151265010E05200012811906200101128119062001011280F908200111811D128119052000128121062001128089080520001281250420011C0E0500011D050E052001011300092000151180810113000615118081010E0D07080E0E0E02125112551259021407070E128089127912808D128091128095128085072002010E12808D0620010112809106200108128089042000127905200201081C052001011279090703021180991180990500001281350520011D050E052001011D050907030211809D11809D0420001D050520010E1D050A07041280A10E0211809D0A07031180A51180A512590500001180A5050002010E0E0500001281450720020E0E1281490500010E1D0E040701125906000111809D0E0607021D0512590500010E1D051407061280AD1280B11280B51280B91280BD11809D0500001280AD0920021280B11D051D050C2003011280D91280B1118151062001011280D90A07060E02020E1255125908000212550E1181110400010E0E060003010E0E020507011180C10600011180C10204061180C104070112100600011180CD08120705021255151280D1011280D51280D51259072002020E11815905000112550E0A20001512815D011280D5081512815D011280D508151280D1011280D5032000080A07040E0E12808D12809105200012816507200212816D0E1C0507021D050E0907031280D91280B50E0520001280D90707030E0211809D040611809D0600030E0E0E0E0520020E0E0E29070F15126501151280F1070E0E0E0E0E0E0E12691280F50212808512751280F90E0E0E0E0E0E0E127D1015126501151280F1070E0E0E0E0E0E0E0620011280F50E24100707151280F1071E001E011E021E031E041E051E061E001E011E021E031E041E051E06090A070E0E0E0E0E0E0E0E0701151280F1070E0E0E0E0E0E0E0C151280F1070E0E0E0E0E0E0E0420001301042000130204200013030420001304042000130504200013060507030E020E05200011818102060E0520001280F9050002020E0E0907051280F908020E022D07170E0E0E151265011D1C0212808D1280911280FD0E0E02020E0212691280F9021280F91280F9020202128085042001020E0500020E0E1C06151265011D1C0520001280FD05200012818D0620011280F90E13070A0212751280F90212751280F9127D020E0E0520001280F50407011D1C021D1C03000008030701080807060208020202080320000A0420010E08040701121408B77A5C561934E089404200350030003000330045003200460036003600390034003400430043003100390031003100310037003100420044003800450035003500440031003200330020320035003000430042003100380033003500390042003500340039004200420002060802061C030612550906151280D1011280D504061280D504061280D904061280B503061D050900050E0E0E0E1D05020800030112610E100E0B0006010E0E0E1D0502100E08000212808512610E08000111809911809D08000111809D11809908000111809D11809D070003010E0E100E0C0003010E101280A91011809D0C0003010E1011809D1011809D080004010E0E02100E0800011180C111809D0B000212808511809D1180C1140005011C101180CD1011809D1011809D1011809D0C00030111809D1180CD1180C106000301080E0E0600010E1280D50A0002128085126111809D200008011C1011809D1011809D1011809D1011809D1011809D1011809D1011809D0600010E1280F90700020E1280F9080B000212808511809D11809D0E0004011280F90E151265011D1C0E1C0007011C1011809D1011809D1011809D1011809D101180C11011809D082000151280D1011C032800080328000E0328001C0801000800000000001E01000100540216577261704E6F6E457863657074696F6E5468726F7773010801000701000000001101000C427261766F4D616E546F6F6C00000501000000001301000E425241564F20534F46545741524500001D010018427261766F20436F7079726967687420C2A920203230323100002901002435363462306235662D653338652D343831642D393138632D32346537376531366462626600000C010007312E302E302E3000004901001A2E4E45544672616D65776F726B2C56657273696F6E3D76342E350100540E144672616D65776F726B446973706C61794E616D65122E4E4554204672616D65776F726B20342E35814C01000300540E044E616D651E75666E5F7379735F577269746546696C6546726F6D56617242696E61727954557F4D6963726F736F66742E53716C5365727665722E5365727665722E53797374656D446174614163636573734B696E642C2053797374656D2E446174612C2056657273696F6E3D342E302E302E302C2043756C747572653D6E65757472616C2C205075626C69634B6579546F6B656E3D623737613563353631393334653038391053797374656D44617461416363657373010000005455794D6963726F736F66742E53716C5365727665722E5365727665722E446174614163636573734B696E642C2053797374656D2E446174612C2056657273696F6E3D342E302E302E302C2043756C747572653D6E65757472616C2C205075626C69634B6579546F6B656E3D623737613563353631393334653038390A44617461416363657373010000000401000000240100020054020F497344657465726D696E697374696301540209497350726563697365013201002D427261766F4D616E546F6F6C2E427261766F4D616E546F6F6C2B3C4578747261637446696C65733E645F5F31350000808901000200540E1146696C6C526F774D6574686F644E616D650D46696C6C526F774D6574686F64540E0F5461626C65446566696E6974696F6E50496420494E542C2046696C654E616D65204E5641524348415228323630292C2046696C65457874656E73696F6E204E56415243484152283130292C20426173653634204E56415243484152284D415829810601000200540E1146696C6C526F774D6574686F644E616D650E46696C6C526F7745787472616374540E0F5461626C65446566696E6974696F6E80CB436F6D6D616E6456616C7565204E56415243484152284D4158292C20436F6D6D616E6450617468204E56415243484152284D4158292C20506172656E745461674E616D6531204E56415243484152284D4158292C20506172656E745461674E616D6532204E56415243484152284D4158292C20506172656E745461674E616D6533204E56415243484152284D4158292C20506172656E745461674E616D6534204E56415243484152284D4158292C20506172656E745461674E616D6535204E56415243484152284D415829814601000300540E1146696C6C526F774D6574686F644E616D650746696C6C526F77540E0F5461626C65446566696E6974696F6E8087466F726D4E616D65206E7661726368617228313030292C204C61796F75744E616D65206E7661726368617228313030292C20466F726D54657874206E76617263686172286D6178292C20444C4C4E616D65206E7661726368617228313030292C20497354656D706C617465206269742C20506174684E616D65206E76617263686172286D6178295455794D6963726F736F66742E53716C5365727665722E5365727665722E446174614163636573734B696E642C2053797374656D2E446174612C2056657273696F6E3D342E302E302E302C2043756C747572653D6E65757472616C2C205075626C69634B6579546F6B656E3D623737613563353631393334653038390A44617461416363657373010000000801000000000000000000000091603CD5000000000200000060000000C46F0000C45100000000000000000000000000001000000000000000000000000000000052534453404284A62D0D4B44B270AC772C8D2D4A01000000443A5C7A50726F6A6563745F446F744E65745C427261766F4D616E546F6F6C5C427261766F4D616E546F6F6C5C6F626A5C44656275675C427261766F4D616E546F6F6C2E706462004C70000000000000000000006670000000200000000000000000000000000000000000000000000058700000000000000000000000005F436F72446C6C4D61696E006D73636F7265652E646C6C0000000000FF25002000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100000001800008000000000000000000000000000000100010000003000008000000000000000000000000000000100000000004800000058800000640300000000000000000000640334000000560053005F00560045005200530049004F004E005F0049004E0046004F0000000000BD04EFFE00000100000001000000000000000100000000003F000000000000000400000002000000000000000000000000000000440000000100560061007200460069006C00650049006E0066006F00000000002400040000005400720061006E0073006C006100740069006F006E00000000000000B004C4020000010053007400720069006E006700460069006C00650049006E0066006F000000A002000001003000300030003000300034006200300000001A000100010043006F006D006D0065006E00740073000000000000003E000F00010043006F006D00700061006E0079004E0061006D0065000000000042005200410056004F00200053004F004600540057004100520045000000000042000D000100460069006C0065004400650073006300720069007000740069006F006E000000000042007200610076006F004D0061006E0054006F006F006C0000000000300008000100460069006C006500560065007200730069006F006E000000000031002E0030002E0030002E003000000042001100010049006E007400650072006E0061006C004E0061006D006500000042007200610076006F004D0061006E0054006F006F006C002E0064006C006C00000000005400180001004C006500670061006C0043006F007000790072006900670068007400000042007200610076006F00200043006F0070007900720069006700680074002000A90020002000320030003200310000002A00010001004C006500670061006C00540072006100640065006D00610072006B00730000000000000000004A00110001004F0072006900670069006E0061006C00460069006C0065006E0061006D006500000042007200610076006F004D0061006E0054006F006F006C002E0064006C006C00000000003A000D000100500072006F0064007500630074004E0061006D0065000000000042007200610076006F004D0061006E0054006F006F006C0000000000340008000100500072006F006400750063007400560065007200730069006F006E00000031002E0030002E0030002E003000000038000800010041007300730065006D0062006C0079002000560065007200730069006F006E00000031002E0030002E0030002E00300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007000000C000000783000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
WITH PERMISSION_SET = UNSAFE
GO

CREATE PROCEDURE [dbo].[usp_sys_ZipFolder]
	@_PathFolder [NVARCHAR](256),
	@_ZipPath [NVARCHAR](256),
	@_ResultMessage [NVARCHAR](MAX) OUTPUT
WITH EXECUTE AS CALLER
AS
EXTERNAL NAME [BravoManTool].[BravoManTool.BravoManTool].[zipFolder]
GO

/*
--Đưa toàn bộ các file varbinary nén thành 1 file zip
DECLARE @_XML XML, @_FilePath NVARCHAR(MAX) = 'D:\testZipFile.zip'

SELECT @_XML = 
(	
	SELECT TOP 10 RTRIM(Id) + '.jpg' AS FileName, Image AS FileContent
	FROM dbo.B20ImageStore 
	WHERE Image IS NOT NULL
	FOR XML AUTO, BINARY BASE64,ROOT('root')
)

DECLARE @_ResultMessage NVARCHAR(MAX);
EXECUTE dbo.usp_sys_ZipFromListFileXML 
	@_XML = @_XML, -- xml
	@_FileName = @_FilePath, -- nvarchar(256)
	@_ResultMessage = @_ResultMessage OUTPUT -- nvarchar(max)

PRINT @_ResultMessage
*/
CREATE PROCEDURE [dbo].[usp_sys_ZipFromListFileXML]
	@_XML XML,
	@_FileName [NVARCHAR](256),
	@_ResultMessage [NVARCHAR](MAX) OUTPUT
WITH EXECUTE AS CALLER
AS
EXTERNAL NAME [BravoManTool].[BravoManTool.BravoManTool].[zipFromListFileXML]
GO


/*
--31/08/2023
--Thêm thủ tục lấy giá trị varbinary từ đường dẫn server SQL 
--ResultMessage trả về thành công "OK" hoặc lỗi

DECLARE @_FileBinary VARBINARY(MAX),
        @_ResultMessage NVARCHAR(MAX);
EXEC [dbo].[usp_sys_GetBinaryFromFilePath] @_FilePath = N'D:\test.xml',                        -- nvarchar(max)
                                           @_FileBinary = @_FileBinary OUTPUT,      -- varbinary(max)
                                           @_ResultMessage = @_ResultMessage OUTPUT -- nvarchar(max)

SELECT @_FileBinary, @_ResultMessage
IF @_ResultMessage = 'OK'
	PRINT N'Lấy file thành công'
*/
CREATE PROCEDURE [dbo].[usp_sys_GetBinaryFromFilePath]
	@_FilePath NVARCHAR(MAX),
	@_FileBinary VARBINARY(MAX) OUTPUT,
	@_ResultMessage [NVARCHAR](MAX) OUTPUT
WITH EXECUTE AS CALLER
AS
EXTERNAL NAME [BravoManTool].[BravoManTool.BravoManTool].[GetFileBytes]
GO


CREATE PROCEDURE [dbo].[usp_sys_GetBase64FromFilePath]
    @_FilePath NVARCHAR(MAX),
    @_Base64Data NVARCHAR(MAX) OUTPUT,
    @_ResultMessage NVARCHAR(MAX) OUTPUT
WITH EXECUTE AS CALLER
AS EXTERNAL NAME [BravoManTool].[BravoManTool.BravoManTool].[GetBase64FromFilePath]
GO

-- Tạo hàm CLR
CREATE FUNCTION ufn_sys_BravoManEncrypt(@_PlanText NVARCHAR(MAX))
RETURNS NVARCHAR(MAX)
AS EXTERNAL NAME [BravoManTool].[BravoManTool.BravoManTool].[BravoManEncrypt];
GO


--21/11/2023 thêm hàm move file từ đường dẫn A sang đường dẫn B, và có hỗ trợ @_IsZipFile zip file trước khi chuyển
CREATE PROCEDURE [dbo].[usp_sys_MoveFileFromPath]
    @_SourceFilePath NVARCHAR(MAX),
    @_DestFilePath NVARCHAR(MAX),
    @_IsZipFile BIT,
    @_ResultMessage NVARCHAR(MAX) OUTPUT
WITH EXECUTE AS CALLER
AS EXTERNAL NAME [BravoManTool].[BravoManTool.BravoManTool].[MoveFileFromPath]
GO

CREATE FUNCTION dbo.ufn_sys_ExtractFiles
(
	@_FilePath NVARCHAR(4000), 
	@_ExtractZip BIT
)
RETURNS TABLE (
    Id INT, 
    FileName NVARCHAR(260), 
    FileExtension NVARCHAR(10), 
    Base64 NVARCHAR(MAX)
)
AS EXTERNAL NAME [BravoManTool].[BravoManTool.BravoManTool].ExtractFiles
GO

GO

--
/*
;WITH cte AS (
    SELECT a.FormName, 
        CAST(dbo.ufn_sys_ToLayoutXml(b.LayoutData) AS XML) AS DataXML,
		c.DLLName, c.ClassName
    FROM dbo.B00Layout a
		INNER JOIN dbo.B00LayoutData b ON b.Id = a.Id
		INNER JOIN dbo.B00Command c ON c.CommandKey = a.FormName
	WHERE c.IsActive = 1
)
SELECT 
    cte.DLLName, cte.FormName,
    cmd.Value,
    cmd.Path,
    cmd.ParentTagName1,
    cmd.ParentTagName2,
    cmd.ParentTagName3,
    cmd.ParentTagName4,
    cmd.ParentTagName5
FROM cte
	CROSS APPLY dbo.ufn_sys_ExtractLayoutFromTagName(cte.DataXML, 'Command') AS cmd
ORDER BY cte.DLLName

*/
CREATE FUNCTION ufn_sys_ExtractLayoutFromTagName
(
    @_XML XML,
    @_TagName NVARCHAR(100)
)
RETURNS TABLE
(
    [Value] NVARCHAR(MAX),
    [Path] NVARCHAR(MAX),
    ParentTagName1 NVARCHAR(MAX),
    ParentTagName2 NVARCHAR(MAX),
    ParentTagName3 NVARCHAR(MAX),
    ParentTagName4 NVARCHAR(MAX),
    ParentTagName5 NVARCHAR(MAX)
)
AS
EXTERNAL NAME [BravoManTool].[BravoManTool.ReadLayoutXML].[ExtractValuesAndPaths]


---
GO
CREATE FUNCTION dbo.[ufn_sys_ConvertHtmlToText](@_Html NVARCHAR(MAX))
RETURNS NVARCHAR(MAX)
AS EXTERNAL NAME [BravoManTool].[BravoManTool.BravoManTool].[ConvertHtmlToText]

GO


